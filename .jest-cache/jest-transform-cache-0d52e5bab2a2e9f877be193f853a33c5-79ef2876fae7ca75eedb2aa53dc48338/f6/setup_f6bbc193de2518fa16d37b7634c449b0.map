{"version":3,"names":["Object","defineProperty","exports","value","prepareDocument","require","dispatchEvent","Clipboard","getDocumentFromNode","level","wait","options","keyMap","keyMap$1","index","api","wrapAsync","defaultOptionsDirect","applyAccept","autoModify","delay","document","globalThis","keyboardMap","defaultKeyMap","pointerMap","pointerEventsCheck","PointerEventsCheckLevel","EachApiCall","skipAutoClose","skipClick","skipHover","writeToClipboard","advanceTimers","Promise","resolve","defaultOptionsSetup","createConfig","defaults","node","getDocument","setupMain","config","_config_document_defaultView","view","defaultView","window","attachClipboardStubToView","createInstance","setupDirect","keyboardState","pointerState","_ref","system","System","setupSub","wrapAndBindImpl","instance","impl","method","args","setLevelRef","ApiLevel","Call","apply","then","ret","get","name","assign","bind","dispatchUIEvent","levelRefs","userEventApi","fromEntries","entries","map","setup","_options_document"],"sources":["setup.js"],"sourcesContent":["'use strict';\n\nObject.defineProperty(exports, '__esModule', { value: true });\n\nvar prepareDocument = require('../document/prepareDocument.js');\nvar dispatchEvent = require('../event/dispatchEvent.js');\nrequire('../utils/click/isClickableInput.js');\nvar Clipboard = require('../utils/dataTransfer/Clipboard.js');\nrequire('../utils/edit/isEditable.js');\nrequire('../utils/edit/maxLength.js');\nrequire('@testing-library/dom/dist/helpers.js');\nrequire('../utils/keyDef/readNextDescriptor.js');\nvar getDocumentFromNode = require('../utils/misc/getDocumentFromNode.js');\nvar level = require('../utils/misc/level.js');\nvar wait = require('../utils/misc/wait.js');\nvar options = require('../options.js');\nrequire('@testing-library/dom');\nvar keyMap = require('../keyboard/keyMap.js');\nvar keyMap$1 = require('../pointer/keyMap.js');\nvar index = require('../system/index.js');\nvar api = require('./api.js');\nvar wrapAsync = require('./wrapAsync.js');\n\n/**\n * Default options applied when API is called per `userEvent.anyApi()`\n */ const defaultOptionsDirect = {\n    applyAccept: true,\n    autoModify: true,\n    delay: 0,\n    document: globalThis.document,\n    keyboardMap: keyMap.defaultKeyMap,\n    pointerMap: keyMap$1.defaultKeyMap,\n    pointerEventsCheck: options.PointerEventsCheckLevel.EachApiCall,\n    skipAutoClose: false,\n    skipClick: false,\n    skipHover: false,\n    writeToClipboard: false,\n    advanceTimers: ()=>Promise.resolve()\n};\n/**\n * Default options applied when API is called per `userEvent().anyApi()`\n */ const defaultOptionsSetup = {\n    ...defaultOptionsDirect,\n    writeToClipboard: true\n};\nfunction createConfig(options = {}, defaults = defaultOptionsSetup, node) {\n    const document = getDocument(options, node, defaults);\n    return {\n        ...defaults,\n        ...options,\n        document\n    };\n}\n/**\n * Start a \"session\" with userEvent.\n * All APIs returned by this function share an input device state and a default configuration.\n */ function setupMain(options = {}) {\n    const config = createConfig(options);\n    prepareDocument.prepareDocument(config.document);\n    var _config_document_defaultView;\n    const view = (_config_document_defaultView = config.document.defaultView) !== null && _config_document_defaultView !== void 0 ? _config_document_defaultView : /* istanbul ignore next */ globalThis.window;\n    Clipboard.attachClipboardStubToView(view);\n    return createInstance(config).api;\n}\n/**\n * Setup in direct call per `userEvent.anyApi()`\n */ function setupDirect({ keyboardState, pointerState, ...options } = {}, node) {\n    const config = createConfig(options, defaultOptionsDirect, node);\n    prepareDocument.prepareDocument(config.document);\n    var _ref;\n    const system = (_ref = pointerState !== null && pointerState !== void 0 ? pointerState : keyboardState) !== null && _ref !== void 0 ? _ref : new index.System();\n    return {\n        api: createInstance(config, system).api,\n        system\n    };\n}\n/**\n * Create a set of callbacks with different default settings but the same state.\n */ function setupSub(options) {\n    return createInstance({\n        ...this.config,\n        ...options\n    }, this.system).api;\n}\nfunction wrapAndBindImpl(instance, impl) {\n    function method(...args) {\n        level.setLevelRef(instance, level.ApiLevel.Call);\n        return wrapAsync.wrapAsync(()=>impl.apply(instance, args).then(async (ret)=>{\n                await wait.wait(instance.config);\n                return ret;\n            }));\n    }\n    Object.defineProperty(method, 'name', {\n        get: ()=>impl.name\n    });\n    return method;\n}\nfunction createInstance(config, system = new index.System()) {\n    const instance = {};\n    Object.assign(instance, {\n        config,\n        dispatchEvent: dispatchEvent.dispatchEvent.bind(instance),\n        dispatchUIEvent: dispatchEvent.dispatchUIEvent.bind(instance),\n        system,\n        levelRefs: {},\n        ...api.userEventApi\n    });\n    return {\n        instance,\n        api: {\n            ...Object.fromEntries(Object.entries(api.userEventApi).map(([name, api])=>[\n                    name,\n                    wrapAndBindImpl(instance, api)\n                ])),\n            setup: setupSub.bind(instance)\n        }\n    };\n}\nfunction getDocument(options, node, defaults) {\n    var _options_document, _ref;\n    return (_ref = (_options_document = options.document) !== null && _options_document !== void 0 ? _options_document : node && getDocumentFromNode.getDocumentFromNode(node)) !== null && _ref !== void 0 ? _ref : defaults.document;\n}\n\nexports.createConfig = createConfig;\nexports.createInstance = createInstance;\nexports.setupDirect = setupDirect;\nexports.setupMain = setupMain;\nexports.setupSub = setupSub;\n"],"mappings":"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"}