{"version":3,"names":["Object","defineProperty","exports","value","require","getTreeDiff","cssPointerEvents","shared","_define_property","obj","key","enumerable","configurable","writable","Pointer","init","instance","position","target","getTarget","enter","getEventInit","assertPointerEvents","dispatchUIEvent","forEach","el","move","prevPosition","prevTarget","isDifferentPointerPosition","nextTarget","leave","hasPointerEvents","down","_keyDef","isDown","isPrevented","up","release","isCancelled","_this_position_target","config","document","body","coords","pointerId","pointerType","isPrimary","constructor","isMultitouch"],"sources":["pointer.js"],"sourcesContent":["'use strict';\n\nObject.defineProperty(exports, '__esModule', { value: true });\n\nrequire('../../utils/click/isClickableInput.js');\nrequire('../../utils/dataTransfer/Clipboard.js');\nrequire('../../utils/edit/isEditable.js');\nrequire('../../utils/edit/maxLength.js');\nrequire('@testing-library/dom/dist/helpers.js');\nrequire('../../utils/keyDef/readNextDescriptor.js');\nvar getTreeDiff = require('../../utils/misc/getTreeDiff.js');\nrequire('../../utils/misc/level.js');\nvar cssPointerEvents = require('../../utils/pointer/cssPointerEvents.js');\nvar shared = require('./shared.js');\n\nfunction _define_property(obj, key, value) {\n    if (key in obj) {\n        Object.defineProperty(obj, key, {\n            value: value,\n            enumerable: true,\n            configurable: true,\n            writable: true\n        });\n    } else {\n        obj[key] = value;\n    }\n    return obj;\n}\nclass Pointer {\n    init(instance, position) {\n        this.position = position;\n        const target = this.getTarget(instance);\n        const [, enter] = getTreeDiff.getTreeDiff(null, target);\n        const init = this.getEventInit();\n        cssPointerEvents.assertPointerEvents(instance, target);\n        instance.dispatchUIEvent(target, 'pointerover', init);\n        enter.forEach((el)=>instance.dispatchUIEvent(el, 'pointerenter', init));\n        return this;\n    }\n    move(instance, position) {\n        const prevPosition = this.position;\n        const prevTarget = this.getTarget(instance);\n        this.position = position;\n        if (!shared.isDifferentPointerPosition(prevPosition, position)) {\n            return;\n        }\n        const nextTarget = this.getTarget(instance);\n        const init = this.getEventInit();\n        const [leave, enter] = getTreeDiff.getTreeDiff(prevTarget, nextTarget);\n        return {\n            leave: ()=>{\n                if (cssPointerEvents.hasPointerEvents(instance, prevTarget)) {\n                    if (prevTarget !== nextTarget) {\n                        instance.dispatchUIEvent(prevTarget, 'pointerout', init);\n                        leave.forEach((el)=>instance.dispatchUIEvent(el, 'pointerleave', init));\n                    }\n                }\n            },\n            enter: ()=>{\n                cssPointerEvents.assertPointerEvents(instance, nextTarget);\n                if (prevTarget !== nextTarget) {\n                    instance.dispatchUIEvent(nextTarget, 'pointerover', init);\n                    enter.forEach((el)=>instance.dispatchUIEvent(el, 'pointerenter', init));\n                }\n            },\n            move: ()=>{\n                instance.dispatchUIEvent(nextTarget, 'pointermove', init);\n            }\n        };\n    }\n    down(instance, _keyDef) {\n        if (this.isDown) {\n            return;\n        }\n        const target = this.getTarget(instance);\n        cssPointerEvents.assertPointerEvents(instance, target);\n        this.isDown = true;\n        this.isPrevented = !instance.dispatchUIEvent(target, 'pointerdown', this.getEventInit());\n    }\n    up(instance, _keyDef) {\n        if (!this.isDown) {\n            return;\n        }\n        const target = this.getTarget(instance);\n        cssPointerEvents.assertPointerEvents(instance, target);\n        this.isDown = false;\n        instance.dispatchUIEvent(target, 'pointerup', this.getEventInit());\n    }\n    release(instance) {\n        const target = this.getTarget(instance);\n        const [leave] = getTreeDiff.getTreeDiff(target, null);\n        const init = this.getEventInit();\n        // Currently there is no PointerEventsCheckLevel that would\n        // make this check not use the *asserted* cached value from `up`.\n        /* istanbul ignore else */ if (cssPointerEvents.hasPointerEvents(instance, target)) {\n            instance.dispatchUIEvent(target, 'pointerout', init);\n            leave.forEach((el)=>instance.dispatchUIEvent(el, 'pointerleave', init));\n        }\n        this.isCancelled = true;\n    }\n    getTarget(instance) {\n        var _this_position_target;\n        return (_this_position_target = this.position.target) !== null && _this_position_target !== void 0 ? _this_position_target : instance.config.document.body;\n    }\n    getEventInit() {\n        return {\n            ...this.position.coords,\n            pointerId: this.pointerId,\n            pointerType: this.pointerType,\n            isPrimary: this.isPrimary\n        };\n    }\n    constructor({ pointerId, pointerType, isPrimary }){\n        _define_property(this, \"pointerId\", void 0);\n        _define_property(this, \"pointerType\", void 0);\n        _define_property(this, \"isPrimary\", void 0);\n        _define_property(this, \"isMultitouch\", false);\n        _define_property(this, \"isCancelled\", false);\n        _define_property(this, \"isDown\", false);\n        _define_property(this, \"isPrevented\", false);\n        _define_property(this, \"position\", {});\n        this.pointerId = pointerId;\n        this.pointerType = pointerType;\n        this.isPrimary = isPrimary;\n        this.isMultitouch = !isPrimary;\n    }\n}\n\nexports.Pointer = Pointer;\n"],"mappings":"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"}