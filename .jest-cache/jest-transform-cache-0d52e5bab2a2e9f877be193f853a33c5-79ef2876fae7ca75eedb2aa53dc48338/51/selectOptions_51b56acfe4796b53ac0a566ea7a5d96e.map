{"version":3,"names":["Object","defineProperty","exports","value","named","require","isElementType","isDisabled","wait","cssPointerEvents","focus","_interopNamespace","e","__esModule","n","create","keys","forEach","k","d","getOwnPropertyDescriptor","get","enumerable","freeze","named__namespace","getConfig","selectOptions","select","values","selectOptionsBase","call","deselectOptions","newValue","multiple","getElementError","valArray","Array","isArray","allOptions","from","querySelectorAll","selectedOptions","map","val","includes","matchingOption","find","o","innerHTML","String","filter","option","length","selectOption","selected","dispatchUIEvent","bubbles","cancelable","composed","withPointerEvents","config","pointerEventsCheck","hasPointerEvents","focusElement","click","getAttribute","unhover"],"sources":["selectOptions.js"],"sourcesContent":["'use strict';\n\nObject.defineProperty(exports, '__esModule', { value: true });\n\nvar named = require('@testing-library/dom');\nrequire('../utils/click/isClickableInput.js');\nrequire('../utils/dataTransfer/Clipboard.js');\nrequire('../utils/edit/isEditable.js');\nrequire('../utils/edit/maxLength.js');\nvar isElementType = require('../utils/misc/isElementType.js');\nvar isDisabled = require('../utils/misc/isDisabled.js');\nrequire('@testing-library/dom/dist/helpers.js');\nrequire('../utils/keyDef/readNextDescriptor.js');\nrequire('../utils/misc/level.js');\nvar wait = require('../utils/misc/wait.js');\nvar cssPointerEvents = require('../utils/pointer/cssPointerEvents.js');\nrequire('../event/behavior/click.js');\nrequire('../event/behavior/cut.js');\nrequire('../event/behavior/keydown.js');\nrequire('../event/behavior/keypress.js');\nrequire('../event/behavior/keyup.js');\nrequire('../event/behavior/paste.js');\nrequire('../event/eventMap.js');\nvar focus = require('../event/focus.js');\n\nfunction _interopNamespace(e) {\n  if (e && e.__esModule) return e;\n  var n = Object.create(null);\n  if (e) {\n    Object.keys(e).forEach(function (k) {\n      if (k !== 'default') {\n        var d = Object.getOwnPropertyDescriptor(e, k);\n        Object.defineProperty(n, k, d.get ? d : {\n          enumerable: true,\n          get: function () { return e[k]; }\n        });\n      }\n    });\n  }\n  n[\"default\"] = e;\n  return Object.freeze(n);\n}\n\nvar named__namespace = /*#__PURE__*/_interopNamespace(named);\n\nconst { getConfig } = named__namespace;\nasync function selectOptions(select, values) {\n    return selectOptionsBase.call(this, true, select, values);\n}\nasync function deselectOptions(select, values) {\n    return selectOptionsBase.call(this, false, select, values);\n}\nasync function selectOptionsBase(newValue, select, values) {\n    if (!newValue && !select.multiple) {\n        throw getConfig().getElementError(`Unable to deselect an option in a non-multiple select. Use selectOptions to change the selection instead.`, select);\n    }\n    const valArray = Array.isArray(values) ? values : [\n        values\n    ];\n    const allOptions = Array.from(select.querySelectorAll('option, [role=\"option\"]'));\n    const selectedOptions = valArray.map((val)=>{\n        if (typeof val !== 'string' && allOptions.includes(val)) {\n            return val;\n        } else {\n            const matchingOption = allOptions.find((o)=>o.value === val || o.innerHTML === val);\n            if (matchingOption) {\n                return matchingOption;\n            } else {\n                throw getConfig().getElementError(`Value \"${String(val)}\" not found in options`, select);\n            }\n        }\n    }).filter((option)=>!isDisabled.isDisabled(option));\n    if (isDisabled.isDisabled(select) || !selectedOptions.length) return;\n    const selectOption = (option)=>{\n        option.selected = newValue;\n        this.dispatchUIEvent(select, 'input', {\n            bubbles: true,\n            cancelable: false,\n            composed: true\n        });\n        this.dispatchUIEvent(select, 'change');\n    };\n    if (isElementType.isElementType(select, 'select')) {\n        if (select.multiple) {\n            for (const option of selectedOptions){\n                const withPointerEvents = this.config.pointerEventsCheck === 0 ? true : cssPointerEvents.hasPointerEvents(this, option);\n                // events fired for multiple select are weird. Can't use hover...\n                if (withPointerEvents) {\n                    this.dispatchUIEvent(option, 'pointerover');\n                    this.dispatchUIEvent(select, 'pointerenter');\n                    this.dispatchUIEvent(option, 'mouseover');\n                    this.dispatchUIEvent(select, 'mouseenter');\n                    this.dispatchUIEvent(option, 'pointermove');\n                    this.dispatchUIEvent(option, 'mousemove');\n                    this.dispatchUIEvent(option, 'pointerdown');\n                    this.dispatchUIEvent(option, 'mousedown');\n                }\n                focus.focusElement(select);\n                if (withPointerEvents) {\n                    this.dispatchUIEvent(option, 'pointerup');\n                    this.dispatchUIEvent(option, 'mouseup');\n                }\n                selectOption(option);\n                if (withPointerEvents) {\n                    this.dispatchUIEvent(option, 'click');\n                }\n                await wait.wait(this.config);\n            }\n        } else if (selectedOptions.length === 1) {\n            const withPointerEvents = this.config.pointerEventsCheck === 0 ? true : cssPointerEvents.hasPointerEvents(this, select);\n            // the click to open the select options\n            if (withPointerEvents) {\n                await this.click(select);\n            } else {\n                focus.focusElement(select);\n            }\n            selectOption(selectedOptions[0]);\n            if (withPointerEvents) {\n                // the browser triggers another click event on the select for the click on the option\n                // this second click has no 'down' phase\n                this.dispatchUIEvent(select, 'pointerover');\n                this.dispatchUIEvent(select, 'pointerenter');\n                this.dispatchUIEvent(select, 'mouseover');\n                this.dispatchUIEvent(select, 'mouseenter');\n                this.dispatchUIEvent(select, 'pointerup');\n                this.dispatchUIEvent(select, 'mouseup');\n                this.dispatchUIEvent(select, 'click');\n            }\n            await wait.wait(this.config);\n        } else {\n            throw getConfig().getElementError(`Cannot select multiple options on a non-multiple select`, select);\n        }\n    } else if (select.getAttribute('role') === 'listbox') {\n        for (const option of selectedOptions){\n            await this.click(option);\n            await this.unhover(option);\n        }\n    } else {\n        throw getConfig().getElementError(`Cannot select options on elements that are neither select nor listbox elements`, select);\n    }\n}\n\nexports.deselectOptions = deselectOptions;\nexports.selectOptions = selectOptions;\n"],"mappings":"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"}