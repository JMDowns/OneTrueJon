f7844baf43e67409b72018567ea524d7
'use strict';

Object.defineProperty(exports, '__esModule', {
  value: true
});
var named = require('@testing-library/dom');
require('../utils/click/isClickableInput.js');
require('../utils/dataTransfer/Clipboard.js');
require('../utils/edit/isEditable.js');
require('../utils/edit/maxLength.js');
var isElementType = require('../utils/misc/isElementType.js');
var isDisabled = require('../utils/misc/isDisabled.js');
require('@testing-library/dom/dist/helpers.js');
require('../utils/keyDef/readNextDescriptor.js');
require('../utils/misc/level.js');
var wait = require('../utils/misc/wait.js');
var cssPointerEvents = require('../utils/pointer/cssPointerEvents.js');
require('../event/behavior/click.js');
require('../event/behavior/cut.js');
require('../event/behavior/keydown.js');
require('../event/behavior/keypress.js');
require('../event/behavior/keyup.js');
require('../event/behavior/paste.js');
require('../event/eventMap.js');
var focus = require('../event/focus.js');
function _interopNamespace(e) {
  if (e && e.__esModule) return e;
  var n = Object.create(null);
  if (e) {
    Object.keys(e).forEach(function (k) {
      if (k !== 'default') {
        var d = Object.getOwnPropertyDescriptor(e, k);
        Object.defineProperty(n, k, d.get ? d : {
          enumerable: true,
          get: function () {
            return e[k];
          }
        });
      }
    });
  }
  n["default"] = e;
  return Object.freeze(n);
}
var named__namespace = /*#__PURE__*/_interopNamespace(named);
const {
  getConfig
} = named__namespace;
async function selectOptions(select, values) {
  return selectOptionsBase.call(this, true, select, values);
}
async function deselectOptions(select, values) {
  return selectOptionsBase.call(this, false, select, values);
}
async function selectOptionsBase(newValue, select, values) {
  if (!newValue && !select.multiple) {
    throw getConfig().getElementError(`Unable to deselect an option in a non-multiple select. Use selectOptions to change the selection instead.`, select);
  }
  const valArray = Array.isArray(values) ? values : [values];
  const allOptions = Array.from(select.querySelectorAll('option, [role="option"]'));
  const selectedOptions = valArray.map(val => {
    if (typeof val !== 'string' && allOptions.includes(val)) {
      return val;
    } else {
      const matchingOption = allOptions.find(o => o.value === val || o.innerHTML === val);
      if (matchingOption) {
        return matchingOption;
      } else {
        throw getConfig().getElementError(`Value "${String(val)}" not found in options`, select);
      }
    }
  }).filter(option => !isDisabled.isDisabled(option));
  if (isDisabled.isDisabled(select) || !selectedOptions.length) return;
  const selectOption = option => {
    option.selected = newValue;
    this.dispatchUIEvent(select, 'input', {
      bubbles: true,
      cancelable: false,
      composed: true
    });
    this.dispatchUIEvent(select, 'change');
  };
  if (isElementType.isElementType(select, 'select')) {
    if (select.multiple) {
      for (const option of selectedOptions) {
        const withPointerEvents = this.config.pointerEventsCheck === 0 ? true : cssPointerEvents.hasPointerEvents(this, option);
        // events fired for multiple select are weird. Can't use hover...
        if (withPointerEvents) {
          this.dispatchUIEvent(option, 'pointerover');
          this.dispatchUIEvent(select, 'pointerenter');
          this.dispatchUIEvent(option, 'mouseover');
          this.dispatchUIEvent(select, 'mouseenter');
          this.dispatchUIEvent(option, 'pointermove');
          this.dispatchUIEvent(option, 'mousemove');
          this.dispatchUIEvent(option, 'pointerdown');
          this.dispatchUIEvent(option, 'mousedown');
        }
        focus.focusElement(select);
        if (withPointerEvents) {
          this.dispatchUIEvent(option, 'pointerup');
          this.dispatchUIEvent(option, 'mouseup');
        }
        selectOption(option);
        if (withPointerEvents) {
          this.dispatchUIEvent(option, 'click');
        }
        await wait.wait(this.config);
      }
    } else if (selectedOptions.length === 1) {
      const withPointerEvents = this.config.pointerEventsCheck === 0 ? true : cssPointerEvents.hasPointerEvents(this, select);
      // the click to open the select options
      if (withPointerEvents) {
        await this.click(select);
      } else {
        focus.focusElement(select);
      }
      selectOption(selectedOptions[0]);
      if (withPointerEvents) {
        // the browser triggers another click event on the select for the click on the option
        // this second click has no 'down' phase
        this.dispatchUIEvent(select, 'pointerover');
        this.dispatchUIEvent(select, 'pointerenter');
        this.dispatchUIEvent(select, 'mouseover');
        this.dispatchUIEvent(select, 'mouseenter');
        this.dispatchUIEvent(select, 'pointerup');
        this.dispatchUIEvent(select, 'mouseup');
        this.dispatchUIEvent(select, 'click');
      }
      await wait.wait(this.config);
    } else {
      throw getConfig().getElementError(`Cannot select multiple options on a non-multiple select`, select);
    }
  } else if (select.getAttribute('role') === 'listbox') {
    for (const option of selectedOptions) {
      await this.click(option);
      await this.unhover(option);
    }
  } else {
    throw getConfig().getElementError(`Cannot select options on elements that are neither select nor listbox elements`, select);
  }
}
exports.deselectOptions = deselectOptions;
exports.selectOptions = selectOptions;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImV4cG9ydHMiLCJ2YWx1ZSIsIm5hbWVkIiwicmVxdWlyZSIsImlzRWxlbWVudFR5cGUiLCJpc0Rpc2FibGVkIiwid2FpdCIsImNzc1BvaW50ZXJFdmVudHMiLCJmb2N1cyIsIl9pbnRlcm9wTmFtZXNwYWNlIiwiZSIsIl9fZXNNb2R1bGUiLCJuIiwiY3JlYXRlIiwia2V5cyIsImZvckVhY2giLCJrIiwiZCIsImdldE93blByb3BlcnR5RGVzY3JpcHRvciIsImdldCIsImVudW1lcmFibGUiLCJmcmVlemUiLCJuYW1lZF9fbmFtZXNwYWNlIiwiZ2V0Q29uZmlnIiwic2VsZWN0T3B0aW9ucyIsInNlbGVjdCIsInZhbHVlcyIsInNlbGVjdE9wdGlvbnNCYXNlIiwiY2FsbCIsImRlc2VsZWN0T3B0aW9ucyIsIm5ld1ZhbHVlIiwibXVsdGlwbGUiLCJnZXRFbGVtZW50RXJyb3IiLCJ2YWxBcnJheSIsIkFycmF5IiwiaXNBcnJheSIsImFsbE9wdGlvbnMiLCJmcm9tIiwicXVlcnlTZWxlY3RvckFsbCIsInNlbGVjdGVkT3B0aW9ucyIsIm1hcCIsInZhbCIsImluY2x1ZGVzIiwibWF0Y2hpbmdPcHRpb24iLCJmaW5kIiwibyIsImlubmVySFRNTCIsIlN0cmluZyIsImZpbHRlciIsIm9wdGlvbiIsImxlbmd0aCIsInNlbGVjdE9wdGlvbiIsInNlbGVjdGVkIiwiZGlzcGF0Y2hVSUV2ZW50IiwiYnViYmxlcyIsImNhbmNlbGFibGUiLCJjb21wb3NlZCIsIndpdGhQb2ludGVyRXZlbnRzIiwiY29uZmlnIiwicG9pbnRlckV2ZW50c0NoZWNrIiwiaGFzUG9pbnRlckV2ZW50cyIsImZvY3VzRWxlbWVudCIsImNsaWNrIiwiZ2V0QXR0cmlidXRlIiwidW5ob3ZlciJdLCJzb3VyY2VzIjpbInNlbGVjdE9wdGlvbnMuanMiXSwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgJ19fZXNNb2R1bGUnLCB7IHZhbHVlOiB0cnVlIH0pO1xuXG52YXIgbmFtZWQgPSByZXF1aXJlKCdAdGVzdGluZy1saWJyYXJ5L2RvbScpO1xucmVxdWlyZSgnLi4vdXRpbHMvY2xpY2svaXNDbGlja2FibGVJbnB1dC5qcycpO1xucmVxdWlyZSgnLi4vdXRpbHMvZGF0YVRyYW5zZmVyL0NsaXBib2FyZC5qcycpO1xucmVxdWlyZSgnLi4vdXRpbHMvZWRpdC9pc0VkaXRhYmxlLmpzJyk7XG5yZXF1aXJlKCcuLi91dGlscy9lZGl0L21heExlbmd0aC5qcycpO1xudmFyIGlzRWxlbWVudFR5cGUgPSByZXF1aXJlKCcuLi91dGlscy9taXNjL2lzRWxlbWVudFR5cGUuanMnKTtcbnZhciBpc0Rpc2FibGVkID0gcmVxdWlyZSgnLi4vdXRpbHMvbWlzYy9pc0Rpc2FibGVkLmpzJyk7XG5yZXF1aXJlKCdAdGVzdGluZy1saWJyYXJ5L2RvbS9kaXN0L2hlbHBlcnMuanMnKTtcbnJlcXVpcmUoJy4uL3V0aWxzL2tleURlZi9yZWFkTmV4dERlc2NyaXB0b3IuanMnKTtcbnJlcXVpcmUoJy4uL3V0aWxzL21pc2MvbGV2ZWwuanMnKTtcbnZhciB3YWl0ID0gcmVxdWlyZSgnLi4vdXRpbHMvbWlzYy93YWl0LmpzJyk7XG52YXIgY3NzUG9pbnRlckV2ZW50cyA9IHJlcXVpcmUoJy4uL3V0aWxzL3BvaW50ZXIvY3NzUG9pbnRlckV2ZW50cy5qcycpO1xucmVxdWlyZSgnLi4vZXZlbnQvYmVoYXZpb3IvY2xpY2suanMnKTtcbnJlcXVpcmUoJy4uL2V2ZW50L2JlaGF2aW9yL2N1dC5qcycpO1xucmVxdWlyZSgnLi4vZXZlbnQvYmVoYXZpb3Iva2V5ZG93bi5qcycpO1xucmVxdWlyZSgnLi4vZXZlbnQvYmVoYXZpb3Iva2V5cHJlc3MuanMnKTtcbnJlcXVpcmUoJy4uL2V2ZW50L2JlaGF2aW9yL2tleXVwLmpzJyk7XG5yZXF1aXJlKCcuLi9ldmVudC9iZWhhdmlvci9wYXN0ZS5qcycpO1xucmVxdWlyZSgnLi4vZXZlbnQvZXZlbnRNYXAuanMnKTtcbnZhciBmb2N1cyA9IHJlcXVpcmUoJy4uL2V2ZW50L2ZvY3VzLmpzJyk7XG5cbmZ1bmN0aW9uIF9pbnRlcm9wTmFtZXNwYWNlKGUpIHtcbiAgaWYgKGUgJiYgZS5fX2VzTW9kdWxlKSByZXR1cm4gZTtcbiAgdmFyIG4gPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuICBpZiAoZSkge1xuICAgIE9iamVjdC5rZXlzKGUpLmZvckVhY2goZnVuY3Rpb24gKGspIHtcbiAgICAgIGlmIChrICE9PSAnZGVmYXVsdCcpIHtcbiAgICAgICAgdmFyIGQgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKGUsIGspO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkobiwgaywgZC5nZXQgPyBkIDoge1xuICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7IHJldHVybiBlW2tdOyB9XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG4gIG5bXCJkZWZhdWx0XCJdID0gZTtcbiAgcmV0dXJuIE9iamVjdC5mcmVlemUobik7XG59XG5cbnZhciBuYW1lZF9fbmFtZXNwYWNlID0gLyojX19QVVJFX18qL19pbnRlcm9wTmFtZXNwYWNlKG5hbWVkKTtcblxuY29uc3QgeyBnZXRDb25maWcgfSA9IG5hbWVkX19uYW1lc3BhY2U7XG5hc3luYyBmdW5jdGlvbiBzZWxlY3RPcHRpb25zKHNlbGVjdCwgdmFsdWVzKSB7XG4gICAgcmV0dXJuIHNlbGVjdE9wdGlvbnNCYXNlLmNhbGwodGhpcywgdHJ1ZSwgc2VsZWN0LCB2YWx1ZXMpO1xufVxuYXN5bmMgZnVuY3Rpb24gZGVzZWxlY3RPcHRpb25zKHNlbGVjdCwgdmFsdWVzKSB7XG4gICAgcmV0dXJuIHNlbGVjdE9wdGlvbnNCYXNlLmNhbGwodGhpcywgZmFsc2UsIHNlbGVjdCwgdmFsdWVzKTtcbn1cbmFzeW5jIGZ1bmN0aW9uIHNlbGVjdE9wdGlvbnNCYXNlKG5ld1ZhbHVlLCBzZWxlY3QsIHZhbHVlcykge1xuICAgIGlmICghbmV3VmFsdWUgJiYgIXNlbGVjdC5tdWx0aXBsZSkge1xuICAgICAgICB0aHJvdyBnZXRDb25maWcoKS5nZXRFbGVtZW50RXJyb3IoYFVuYWJsZSB0byBkZXNlbGVjdCBhbiBvcHRpb24gaW4gYSBub24tbXVsdGlwbGUgc2VsZWN0LiBVc2Ugc2VsZWN0T3B0aW9ucyB0byBjaGFuZ2UgdGhlIHNlbGVjdGlvbiBpbnN0ZWFkLmAsIHNlbGVjdCk7XG4gICAgfVxuICAgIGNvbnN0IHZhbEFycmF5ID0gQXJyYXkuaXNBcnJheSh2YWx1ZXMpID8gdmFsdWVzIDogW1xuICAgICAgICB2YWx1ZXNcbiAgICBdO1xuICAgIGNvbnN0IGFsbE9wdGlvbnMgPSBBcnJheS5mcm9tKHNlbGVjdC5xdWVyeVNlbGVjdG9yQWxsKCdvcHRpb24sIFtyb2xlPVwib3B0aW9uXCJdJykpO1xuICAgIGNvbnN0IHNlbGVjdGVkT3B0aW9ucyA9IHZhbEFycmF5Lm1hcCgodmFsKT0+e1xuICAgICAgICBpZiAodHlwZW9mIHZhbCAhPT0gJ3N0cmluZycgJiYgYWxsT3B0aW9ucy5pbmNsdWRlcyh2YWwpKSB7XG4gICAgICAgICAgICByZXR1cm4gdmFsO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29uc3QgbWF0Y2hpbmdPcHRpb24gPSBhbGxPcHRpb25zLmZpbmQoKG8pPT5vLnZhbHVlID09PSB2YWwgfHwgby5pbm5lckhUTUwgPT09IHZhbCk7XG4gICAgICAgICAgICBpZiAobWF0Y2hpbmdPcHRpb24pIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbWF0Y2hpbmdPcHRpb247XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRocm93IGdldENvbmZpZygpLmdldEVsZW1lbnRFcnJvcihgVmFsdWUgXCIke1N0cmluZyh2YWwpfVwiIG5vdCBmb3VuZCBpbiBvcHRpb25zYCwgc2VsZWN0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0pLmZpbHRlcigob3B0aW9uKT0+IWlzRGlzYWJsZWQuaXNEaXNhYmxlZChvcHRpb24pKTtcbiAgICBpZiAoaXNEaXNhYmxlZC5pc0Rpc2FibGVkKHNlbGVjdCkgfHwgIXNlbGVjdGVkT3B0aW9ucy5sZW5ndGgpIHJldHVybjtcbiAgICBjb25zdCBzZWxlY3RPcHRpb24gPSAob3B0aW9uKT0+e1xuICAgICAgICBvcHRpb24uc2VsZWN0ZWQgPSBuZXdWYWx1ZTtcbiAgICAgICAgdGhpcy5kaXNwYXRjaFVJRXZlbnQoc2VsZWN0LCAnaW5wdXQnLCB7XG4gICAgICAgICAgICBidWJibGVzOiB0cnVlLFxuICAgICAgICAgICAgY2FuY2VsYWJsZTogZmFsc2UsXG4gICAgICAgICAgICBjb21wb3NlZDogdHJ1ZVxuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5kaXNwYXRjaFVJRXZlbnQoc2VsZWN0LCAnY2hhbmdlJyk7XG4gICAgfTtcbiAgICBpZiAoaXNFbGVtZW50VHlwZS5pc0VsZW1lbnRUeXBlKHNlbGVjdCwgJ3NlbGVjdCcpKSB7XG4gICAgICAgIGlmIChzZWxlY3QubXVsdGlwbGUpIHtcbiAgICAgICAgICAgIGZvciAoY29uc3Qgb3B0aW9uIG9mIHNlbGVjdGVkT3B0aW9ucyl7XG4gICAgICAgICAgICAgICAgY29uc3Qgd2l0aFBvaW50ZXJFdmVudHMgPSB0aGlzLmNvbmZpZy5wb2ludGVyRXZlbnRzQ2hlY2sgPT09IDAgPyB0cnVlIDogY3NzUG9pbnRlckV2ZW50cy5oYXNQb2ludGVyRXZlbnRzKHRoaXMsIG9wdGlvbik7XG4gICAgICAgICAgICAgICAgLy8gZXZlbnRzIGZpcmVkIGZvciBtdWx0aXBsZSBzZWxlY3QgYXJlIHdlaXJkLiBDYW4ndCB1c2UgaG92ZXIuLi5cbiAgICAgICAgICAgICAgICBpZiAod2l0aFBvaW50ZXJFdmVudHMpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5kaXNwYXRjaFVJRXZlbnQob3B0aW9uLCAncG9pbnRlcm92ZXInKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5kaXNwYXRjaFVJRXZlbnQoc2VsZWN0LCAncG9pbnRlcmVudGVyJyk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZGlzcGF0Y2hVSUV2ZW50KG9wdGlvbiwgJ21vdXNlb3ZlcicpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmRpc3BhdGNoVUlFdmVudChzZWxlY3QsICdtb3VzZWVudGVyJyk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZGlzcGF0Y2hVSUV2ZW50KG9wdGlvbiwgJ3BvaW50ZXJtb3ZlJyk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZGlzcGF0Y2hVSUV2ZW50KG9wdGlvbiwgJ21vdXNlbW92ZScpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmRpc3BhdGNoVUlFdmVudChvcHRpb24sICdwb2ludGVyZG93bicpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmRpc3BhdGNoVUlFdmVudChvcHRpb24sICdtb3VzZWRvd24nKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZm9jdXMuZm9jdXNFbGVtZW50KHNlbGVjdCk7XG4gICAgICAgICAgICAgICAgaWYgKHdpdGhQb2ludGVyRXZlbnRzKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZGlzcGF0Y2hVSUV2ZW50KG9wdGlvbiwgJ3BvaW50ZXJ1cCcpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmRpc3BhdGNoVUlFdmVudChvcHRpb24sICdtb3VzZXVwJyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHNlbGVjdE9wdGlvbihvcHRpb24pO1xuICAgICAgICAgICAgICAgIGlmICh3aXRoUG9pbnRlckV2ZW50cykge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmRpc3BhdGNoVUlFdmVudChvcHRpb24sICdjbGljaycpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBhd2FpdCB3YWl0LndhaXQodGhpcy5jb25maWcpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2UgaWYgKHNlbGVjdGVkT3B0aW9ucy5sZW5ndGggPT09IDEpIHtcbiAgICAgICAgICAgIGNvbnN0IHdpdGhQb2ludGVyRXZlbnRzID0gdGhpcy5jb25maWcucG9pbnRlckV2ZW50c0NoZWNrID09PSAwID8gdHJ1ZSA6IGNzc1BvaW50ZXJFdmVudHMuaGFzUG9pbnRlckV2ZW50cyh0aGlzLCBzZWxlY3QpO1xuICAgICAgICAgICAgLy8gdGhlIGNsaWNrIHRvIG9wZW4gdGhlIHNlbGVjdCBvcHRpb25zXG4gICAgICAgICAgICBpZiAod2l0aFBvaW50ZXJFdmVudHMpIHtcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmNsaWNrKHNlbGVjdCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGZvY3VzLmZvY3VzRWxlbWVudChzZWxlY3QpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgc2VsZWN0T3B0aW9uKHNlbGVjdGVkT3B0aW9uc1swXSk7XG4gICAgICAgICAgICBpZiAod2l0aFBvaW50ZXJFdmVudHMpIHtcbiAgICAgICAgICAgICAgICAvLyB0aGUgYnJvd3NlciB0cmlnZ2VycyBhbm90aGVyIGNsaWNrIGV2ZW50IG9uIHRoZSBzZWxlY3QgZm9yIHRoZSBjbGljayBvbiB0aGUgb3B0aW9uXG4gICAgICAgICAgICAgICAgLy8gdGhpcyBzZWNvbmQgY2xpY2sgaGFzIG5vICdkb3duJyBwaGFzZVxuICAgICAgICAgICAgICAgIHRoaXMuZGlzcGF0Y2hVSUV2ZW50KHNlbGVjdCwgJ3BvaW50ZXJvdmVyJyk7XG4gICAgICAgICAgICAgICAgdGhpcy5kaXNwYXRjaFVJRXZlbnQoc2VsZWN0LCAncG9pbnRlcmVudGVyJyk7XG4gICAgICAgICAgICAgICAgdGhpcy5kaXNwYXRjaFVJRXZlbnQoc2VsZWN0LCAnbW91c2VvdmVyJyk7XG4gICAgICAgICAgICAgICAgdGhpcy5kaXNwYXRjaFVJRXZlbnQoc2VsZWN0LCAnbW91c2VlbnRlcicpO1xuICAgICAgICAgICAgICAgIHRoaXMuZGlzcGF0Y2hVSUV2ZW50KHNlbGVjdCwgJ3BvaW50ZXJ1cCcpO1xuICAgICAgICAgICAgICAgIHRoaXMuZGlzcGF0Y2hVSUV2ZW50KHNlbGVjdCwgJ21vdXNldXAnKTtcbiAgICAgICAgICAgICAgICB0aGlzLmRpc3BhdGNoVUlFdmVudChzZWxlY3QsICdjbGljaycpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYXdhaXQgd2FpdC53YWl0KHRoaXMuY29uZmlnKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRocm93IGdldENvbmZpZygpLmdldEVsZW1lbnRFcnJvcihgQ2Fubm90IHNlbGVjdCBtdWx0aXBsZSBvcHRpb25zIG9uIGEgbm9uLW11bHRpcGxlIHNlbGVjdGAsIHNlbGVjdCk7XG4gICAgICAgIH1cbiAgICB9IGVsc2UgaWYgKHNlbGVjdC5nZXRBdHRyaWJ1dGUoJ3JvbGUnKSA9PT0gJ2xpc3Rib3gnKSB7XG4gICAgICAgIGZvciAoY29uc3Qgb3B0aW9uIG9mIHNlbGVjdGVkT3B0aW9ucyl7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLmNsaWNrKG9wdGlvbik7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLnVuaG92ZXIob3B0aW9uKTtcbiAgICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICAgIHRocm93IGdldENvbmZpZygpLmdldEVsZW1lbnRFcnJvcihgQ2Fubm90IHNlbGVjdCBvcHRpb25zIG9uIGVsZW1lbnRzIHRoYXQgYXJlIG5laXRoZXIgc2VsZWN0IG5vciBsaXN0Ym94IGVsZW1lbnRzYCwgc2VsZWN0KTtcbiAgICB9XG59XG5cbmV4cG9ydHMuZGVzZWxlY3RPcHRpb25zID0gZGVzZWxlY3RPcHRpb25zO1xuZXhwb3J0cy5zZWxlY3RPcHRpb25zID0gc2VsZWN0T3B0aW9ucztcbiJdLCJtYXBwaW5ncyI6IkFBQUEsWUFBWTs7QUFFWkEsTUFBTSxDQUFDQyxjQUFjLENBQUNDLE9BQU8sRUFBRSxZQUFZLEVBQUU7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