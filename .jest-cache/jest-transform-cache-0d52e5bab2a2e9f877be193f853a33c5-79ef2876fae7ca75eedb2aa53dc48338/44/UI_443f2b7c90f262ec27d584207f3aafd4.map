{"version":3,"names":["Object","defineProperty","exports","value","UIValue","Symbol","UISelection","InitialValue","isUIValue","isUISelectionStart","start","setUIValue","element","undefined","assign","String","getUIValue","setUIValueClean","clearInitialValue","getInitialValue","setUISelectionRaw","selection","setUISelection","focusOffset","focusOffsetParam","anchorOffset","anchorOffsetParam","mode","valueLength","length","sanitizeOffset","o","Math","max","min","startOffset","endOffset","selectionStart","selectionEnd","startObj","Number","setSelectionRange","getUISelection","_element_selectionStart","_element_selectionEnd","_element_UISelection","sel","hasUISelection","setUISelectionClean"],"sources":["UI.js"],"sourcesContent":["'use strict';\n\nObject.defineProperty(exports, '__esModule', { value: true });\n\nconst UIValue = Symbol('Displayed value in UI');\nconst UISelection = Symbol('Displayed selection in UI');\nconst InitialValue = Symbol('Initial value to compare on blur');\nfunction isUIValue(value) {\n    return typeof value === 'object' && UIValue in value;\n}\nfunction isUISelectionStart(start) {\n    return !!start && typeof start === 'object' && UISelection in start;\n}\nfunction setUIValue(element, value) {\n    if (element[InitialValue] === undefined) {\n        element[InitialValue] = element.value;\n    }\n    element[UIValue] = value;\n    // eslint-disable-next-line no-new-wrappers\n    element.value = Object.assign(new String(value), {\n        [UIValue]: true\n    });\n}\nfunction getUIValue(element) {\n    return element[UIValue] === undefined ? element.value : String(element[UIValue]);\n}\n/** Flag the IDL value as clean. This does not change the value.*/ function setUIValueClean(element) {\n    element[UIValue] = undefined;\n}\nfunction clearInitialValue(element) {\n    element[InitialValue] = undefined;\n}\nfunction getInitialValue(element) {\n    return element[InitialValue];\n}\nfunction setUISelectionRaw(element, selection) {\n    element[UISelection] = selection;\n}\nfunction setUISelection(element, { focusOffset: focusOffsetParam, anchorOffset: anchorOffsetParam = focusOffsetParam }, mode = 'replace') {\n    const valueLength = getUIValue(element).length;\n    const sanitizeOffset = (o)=>Math.max(0, Math.min(valueLength, o));\n    const anchorOffset = mode === 'replace' || element[UISelection] === undefined ? sanitizeOffset(anchorOffsetParam) : element[UISelection].anchorOffset;\n    const focusOffset = sanitizeOffset(focusOffsetParam);\n    const startOffset = Math.min(anchorOffset, focusOffset);\n    const endOffset = Math.max(anchorOffset, focusOffset);\n    element[UISelection] = {\n        anchorOffset,\n        focusOffset\n    };\n    if (element.selectionStart === startOffset && element.selectionEnd === endOffset) {\n        return;\n    }\n    // eslint-disable-next-line no-new-wrappers\n    const startObj = Object.assign(new Number(startOffset), {\n        [UISelection]: true\n    });\n    try {\n        element.setSelectionRange(startObj, endOffset);\n    } catch  {\n    // DOMException for invalid state is expected when calling this\n    // on an element without support for setSelectionRange\n    }\n}\nfunction getUISelection(element) {\n    var _element_selectionStart, _element_selectionEnd, _element_UISelection;\n    const sel = (_element_UISelection = element[UISelection]) !== null && _element_UISelection !== void 0 ? _element_UISelection : {\n        anchorOffset: (_element_selectionStart = element.selectionStart) !== null && _element_selectionStart !== void 0 ? _element_selectionStart : 0,\n        focusOffset: (_element_selectionEnd = element.selectionEnd) !== null && _element_selectionEnd !== void 0 ? _element_selectionEnd : 0\n    };\n    return {\n        ...sel,\n        startOffset: Math.min(sel.anchorOffset, sel.focusOffset),\n        endOffset: Math.max(sel.anchorOffset, sel.focusOffset)\n    };\n}\nfunction hasUISelection(element) {\n    return !!element[UISelection];\n}\n/** Flag the IDL selection as clean. This does not change the selection. */ function setUISelectionClean(element) {\n    element[UISelection] = undefined;\n}\n\nexports.clearInitialValue = clearInitialValue;\nexports.getInitialValue = getInitialValue;\nexports.getUISelection = getUISelection;\nexports.getUIValue = getUIValue;\nexports.hasUISelection = hasUISelection;\nexports.isUISelectionStart = isUISelectionStart;\nexports.isUIValue = isUIValue;\nexports.setUISelection = setUISelection;\nexports.setUISelectionClean = setUISelectionClean;\nexports.setUISelectionRaw = setUISelectionRaw;\nexports.setUIValue = setUIValue;\nexports.setUIValueClean = setUIValueClean;\n"],"mappings":"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"}